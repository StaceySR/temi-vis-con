!function(e){function t(t){for(var a,c,i=t[0],r=t[1],l=t[2],u=0,p=[];u<i.length;u++)c=i[u],Object.prototype.hasOwnProperty.call(s,c)&&s[c]&&p.push(s[c][0]),s[c]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);for(d&&d(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var r=n[i];0!==s[r]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},s={index:0},o=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=(r=window.webpackJsonp=window.webpackJsonp||[]).push.bind(r);r.push=t;for(var r=r.slice(),l=0;l<r.length;l++)t(r[l]);var d=i;o.push([0,"chunk-vendors"]),n()}({0:function(e,t,n){e.exports=n("c31f")},1064:function(e,t,n){},"1bae":function(e,t,n){},"24cf":function(e,t,n){},2599:function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-tips",use:"icon-tips-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-tips"><defs><style></style></defs><path d="M187.744 156.544a34.112 34.112 0 10-48.256 48.256l48.256 48.256A34.112 34.112 0 10236 204.8l-48.256-48.256zm648.576 0L788 204.8a34.112 34.112 0 0048.32 48.256l48.256-48.256a34.112 34.112 0 10-48.256-48.256zm-733.888 270.08H34.144a34.112 34.112 0 100 68.288h68.288a34.112 34.112 0 000-68.224zm887.424 0h-68.224a34.112 34.112 0 100 68.288h68.224a34.112 34.112 0 000-68.224zm-512-392.512V102.4a34.112 34.112 0 1068.288 0V34.112a34.112 34.112 0 00-68.224 0zM273.12 512a238.912 238.912 0 11477.888 0 238.912 238.912 0 01-477.824 0zm-68.288 0a307.2 307.2 0 10614.4 0 307.2 307.2 0 00-614.4 0zm238.912 477.888c0 18.816 15.296 34.112 34.176 34.112h68.224a34.112 34.112 0 000-68.288H477.92a34.112 34.112 0 00-34.176 34.176zm-68.224-102.4c0 18.816 15.232 34.112 34.112 34.112h204.8a34.112 34.112 0 000-68.288h-204.8a34.112 34.112 0 00-34.112 34.176z" /></symbol>'});n.a.add(s),t.default=s},"27ff":function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-undo",use:"icon-undo-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-undo"><path d="M178.7 661.3h214.1c7.1 0 10.7-8.6 5.7-13.7l-74.3-74.3C363.9 504.6 447.7 448 554.7 448c142.9 0 209.9 105.1 213.2 205.6.1 4.3 3.7 7.8 8 7.8h69.4c4.5 0 8.1-3.7 8-8.2-3.7-145.7-106.1-290.5-298.6-290.5-131.8 0-235.4 64.5-292.5 148.8l-77.9-77.9c-5-5-13.7-1.5-13.7 5.7v214.1c.1 4.4 3.6 7.9 8.1 7.9z" /></symbol>'});n.a.add(s),t.default=s},"2d94":function(e,t,n){"use strict";n("afa7")},"332d":function(e,t,n){"use strict";n("5cf7")},"42b1":function(e,t,n){"use strict";n("bdd4")},"5cf7":function(e,t,n){},6259:function(e,t,n){},"65b8":function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-copy",use:"icon-copy-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-copy"><path d="M568 491.2H342.4c-11.2 0-19.2 8-19.2 19.2s8 19.2 19.2 19.2H568c11.2 0 19.2-8 19.2-19.2s-8-19.2-19.2-19.2zm0 116.8H342.4c-11.2 0-19.2 8-19.2 19.2s8 19.2 19.2 19.2H568c11.2 0 19.2-8 19.2-19.2 0-9.6-8-19.2-19.2-19.2z" /><path d="M737.6 211.2H398.4c-41.6 0-75.2 33.6-75.2 75.2v36.8h-36.8c-41.6 0-75.2 33.6-75.2 75.2v339.2c0 41.6 33.6 75.2 75.2 75.2h339.2c41.6 0 75.2-33.6 75.2-75.2v-36.8h36.8c41.6 0 75.2-33.6 75.2-75.2V286.4c0-41.6-33.6-75.2-75.2-75.2zm-75.2 526.4c0 20.8-16 38.4-38.4 38.4H286.4c-20.8 0-38.4-16-38.4-38.4V398.4c0-20.8 16-38.4 38.4-38.4h339.2c20.8 0 38.4 16 38.4 38.4v339.2zm113.6-112c0 20.8-16 38.4-38.4 38.4h-36.8V398.4c0-41.6-33.6-75.2-75.2-75.2h-264v-36.8c0-20.8 16-38.4 38.4-38.4h339.2c20.8 0 38.4 16 38.4 38.4v339.2z" /></symbol>'});n.a.add(s),t.default=s},"6ba9":function(e,t,n){"use strict";n("24cf")},"728e":function(e,t,n){n("af13"),n("093e"),n("1755");n=n("f160");(n=n).keys().map(n)},7477:function(e,t,n){var a=n("9061").default,s=n("f8c5").default,o=n("4f45").default,c=n("e7ae").default,i=n("19a2").default,r=n("cc6b").default;n("3971"),n=function(e){"use strict";c(n,e);var t=i(n);function n(e,a){var o;return s(this,n),(o=t.call(this,a)).errorCode=e,o.errorMsg=a,o}return o(n,null,[{key:"__ErrorMap",value:function(e){var t={};return a(t,n.InvalidParameters,2e3),a(t,n.VerifyFailure,2001),a(t,n.InvalidFormatData,2002),t[e]}},{key:"isTypeOf",value:function(e,t){return!!e&&e.errorCode===n.__ErrorMap(t)}},{key:"InvalidParameters",value:function(e){return new n(2e3,e||"invalid parameters")}},{key:"VerifyFailure",value:function(e){return new n(2001,e||"verify failure")}},{key:"InvalidFormatData",value:function(e){return new n(2002,e||"invalid format data")}}]),n}(r(Error));e.exports=n},7617:function(e,t,n){},"774b":function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-zoomout",use:"icon-zoomout-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-zoomout"><path d="M607.516 665.543a256 256 0 10-362.154-362.04 256 256 0 00362.154 362.04zm241.21 200.306a28.444 28.444 0 01-40.221 40.22L627.143 724.708a312.889 312.889 0 1140.164-40.278l181.418 181.42zM343.95 455.11a28.444 28.444 0 000 56.889h170.667a28.444 28.444 0 000-56.889H343.95z" /></symbol>'});n.a.add(s),t.default=s},"77ab":function(e,t,n){"use strict";n("1064")},"7ca1":function(e,t,n){},"7f00":function(e,t,n){"use strict";n("7617")},"8b97":function(e,t,n){"use strict";n("a6e8")},"8eda":function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-dustbin",use:"icon-dustbin-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-dustbin"><path d="M800.577 315.98c-.412-.042-.83-.064-1.253-.064H686.612v-70.028c0-23.204-18.812-42.018-42.018-42.018h-266.11c-23.206 0-42.019 18.814-42.019 42.018v70.028H224.857c-.061 0-.12-.01-.182-.01-11.61 0-21.022 9.412-21.022 21.023 0 11.61 9.412 21.021 21.022 21.021.094 0 .185-.013.28-.014h573.908c.155.003.305.024.46.024 11.61 0 21.023-9.412 21.023-21.022 0-11.188-8.745-20.308-19.769-20.958zm-155.983-.064h-266.11v-56.022c0-7.736 6.27-14.006 14.005-14.006h238.1c7.735 0 14.006 6.27 14.006 14.006v56.022zM441.506 703.945c11.61 0 21.022-9.412 21.022-21.022 0-.22-.025-.431-.032-.648.005-.151.022-.3.022-.453V427.109c.017-.35.053-.696.053-1.05 0-11.61-9.411-21.022-21.022-21.022-11.609 0-21.021 9.411-21.021 21.022 0 .067.009.133.01.2-.015.252-.038.502-.038.757v254.807c0 .135.016.266.02.4-.008.234-.035.463-.035.7 0 11.61 9.412 21.022 21.021 21.022zM721.644 405c-11.61 0-21.022 9.411-21.022 21.022 0 .08.011.156.012.235l-.017.042v317.2c0 23.205-11.407 34.61-34.614 34.61h-308.93c-23.206 0-34.614-11.405-34.614-34.61V426.834c.01-.259.039-.512.039-.773 0-11.61-9.411-21.022-21.022-21.022-11.61 0-21.022 9.411-21.022 21.022 0 .061.01.121.01.183-.007.02-.017.038-.024.057v351.81c0 23.206 18.812 42.02 42.018 42.02h378.159c23.205 0 42.018-18.814 42.018-42.02V426.618c.005-.2.03-.394.03-.595 0-11.61-9.41-21.02-21.021-21.02zm-119.067 22.69a20.93 20.93 0 00.084-1.67c0-11.609-9.412-21.021-21.02-21.021-11.494 0-20.818 9.226-21.005 20.675-.048.441-.077.887-.077 1.341v254.807c0 .233.021.46.035.69-.002.126-.019.248-.019.374 0 11.61 9.412 21.02 21.022 21.02 11.61 0 21.022-9.41 21.022-21.02 0-.317-.034-.625-.047-.938 0-.042.006-.083.006-.126V427.69z" /></symbol>'});n.a.add(s),t.default=s},"9b3e":function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-select_cancel",use:"icon-select_cancel-usage",viewBox:"0 0 48 48",content:'<symbol viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" id="icon-select_cancel">\r\n<path d="M31.6487 34.8919H10.2432C9.38308 34.8919 8.55816 34.5502 7.94994 33.942C7.34171 33.3337 7.00001 32.5088 7 31.6487V10.2432C7.00001 9.38307 7.34172 8.55814 7.94995 7.94992C8.55818 7.3417 9.38312 7 10.2433 7H31.6487C32.5088 7 33.3338 7.3417 33.942 7.94994C34.5502 8.55817 34.8919 9.38311 34.8919 10.2433V31.6487C34.8919 32.0746 34.808 32.4963 34.6451 32.8898C34.4821 33.2833 34.2432 33.6408 33.942 33.942C33.6408 34.2432 33.2833 34.4821 32.8898 34.6451C32.4963 34.808 32.0746 34.8919 31.6487 34.8919ZM10.2432 9.59458C10.0712 9.59458 9.90621 9.66292 9.78457 9.78457C9.66292 9.90621 9.59458 10.0712 9.59458 10.2432V31.6487C9.59458 31.8207 9.66292 31.9857 9.78457 32.1073C9.90621 32.229 10.0712 32.2973 10.2432 32.2973H31.6487C31.8207 32.2973 31.9857 32.229 32.1073 32.1073C32.229 31.9857 32.2973 31.8207 32.2973 31.6487V10.2432C32.2973 10.0712 32.229 9.90621 32.1073 9.78457C31.9857 9.66292 31.8207 9.59458 31.6487 9.59458H10.2432ZM36.8379 40.0811H14.7838C13.9236 40.0811 13.0987 39.7394 12.4905 39.1311C11.8822 38.5229 11.5405 37.698 11.5405 36.8378V33.5946C11.5426 33.2519 11.6802 32.9239 11.9233 32.6823C12.1663 32.4407 12.4951 32.3051 12.8378 32.3051C13.1806 32.3051 13.5093 32.4407 13.7524 32.6823C13.9955 32.9239 14.1331 33.2519 14.1351 33.5946V36.8379C14.1351 37.0099 14.2035 37.1749 14.3251 37.2965C14.4468 37.4182 14.6117 37.4865 14.7838 37.4865H36.8379C37.0099 37.4865 37.1749 37.4182 37.2965 37.2965C37.4182 37.1749 37.4865 37.0099 37.4865 36.8379V14.7838C37.4865 14.6117 37.4182 14.4468 37.2965 14.3251C37.1749 14.2035 37.0099 14.1351 36.8379 14.1351H33.5946C33.2519 14.1331 32.9239 13.9955 32.6823 13.7524C32.4407 13.5093 32.3051 13.1806 32.3051 12.8378C32.3051 12.4951 32.4407 12.1663 32.6823 11.9233C32.9239 11.6802 33.2519 11.5426 33.5946 11.5405H36.8379C37.698 11.5406 38.523 11.8823 39.1312 12.4905C39.7394 13.0987 40.0811 13.9237 40.0811 14.7838V36.8379C40.0811 37.698 39.7394 38.523 39.1311 39.1312C38.5229 39.7394 37.698 40.0811 36.8379 40.0811Z" fill="black" />\r\n<path d="M24.2846 16.3297L21.1031 19.5123L17.9216 16.3297C17.817 16.2252 17.693 16.1423 17.5564 16.0857C17.4198 16.0291 17.2734 16 17.1256 16C16.8271 16 16.5408 16.1186 16.3297 16.3297C16.2252 16.4342 16.1423 16.5583 16.0857 16.6949C16.0291 16.8314 16 16.9778 16 17.1256C16 17.2734 16.0291 17.4198 16.0857 17.5564C16.1423 17.693 16.2252 17.817 16.3297 17.9216L19.5123 21.1031L16.3297 24.2846C16.2252 24.3891 16.1423 24.5132 16.0857 24.6497C16.0291 24.7863 16 24.9327 16 25.0805C16 25.379 16.1186 25.6653 16.3297 25.8764C16.4342 25.981 16.5583 26.0639 16.6949 26.1204C16.8314 26.177 16.9778 26.2061 17.1256 26.2061C17.2734 26.2061 17.4198 26.177 17.5564 26.1204C17.693 26.0639 17.817 25.981 17.9216 25.8764L21.1031 22.6938L24.2846 25.8764C24.4957 26.0875 24.782 26.2061 25.0805 26.2061C25.379 26.2061 25.6653 26.0875 25.8764 25.8764C26.0875 25.6653 26.2061 25.379 26.2061 25.0805C26.2061 24.782 26.0875 24.4957 25.8764 24.2846L22.6938 21.1031L25.8764 17.9216C25.981 17.817 26.0639 17.693 26.1204 17.5564C26.177 17.4198 26.2061 17.2734 26.2061 17.1256C26.2061 16.9778 26.177 16.8314 26.1204 16.6949C26.0639 16.5583 25.981 16.4342 25.8764 16.3297C25.7719 16.2252 25.6478 16.1423 25.5113 16.0857C25.3747 16.0291 25.2283 16 25.0805 16C24.9327 16 24.7863 16.0291 24.6497 16.0857C24.5132 16.1423 24.3891 16.2252 24.2846 16.3297Z" fill="black" />\r\n</symbol>'});n.a.add(s),t.default=s},a6e8:function(e,t,n){},ab20:function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-zoomin",use:"icon-zoomin-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-zoomin"><path d="M426.496 740.58a256 256 0 100-512 256 256 0 000 512zm-28.274-285.47H343.95a28.444 28.444 0 000 56.889h54.272v56.889a28.444 28.444 0 0056.89 0V512h59.505a28.444 28.444 0 000-56.889H455.11v-56.889a28.444 28.444 0 00-56.889 0v56.89zm410.283 450.96L627.086 724.651a312.889 312.889 0 11-200.59-553.017 312.889 312.889 0 01240.754 512.74l181.475 181.475a28.444 28.444 0 01-40.22 40.22z" /></symbol>'});n.a.add(s),t.default=s},afa7:function(e,t,n){},b423:function(e,t,n){"use strict";n("6259")},b933:function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-redo",use:"icon-redo-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-redo"><path d="M853.3 653.4V439.3c0-7.2-8.7-10.7-13.7-5.7l-77.9 77.9C704.6 427.2 601 362.7 469.2 362.7c-192.5 0-294.9 144.8-298.6 290.5-.1 4.5 3.5 8.2 8 8.2H248c4.3 0 7.9-3.5 8-7.8C259.3 553.1 326.3 448 469.2 448c107 0 190.8 56.6 230.5 125.3l-74.3 74.3c-5 5.1-1.4 13.7 5.7 13.7h214.1c4.5 0 8-3.5 8.1-7.9z" /></symbol>'});n.a.add(s),t.default=s},bdd4:function(e,t,n){},bde3:function(e,t,n){"use strict";n("7ca1")},c31f:function(e,t,n){"use strict";function a(e,t){document.querySelectorAll('g[data-cell-id="'.concat(e.id,'"] .x6-port-body')).forEach((function(e){e.style.color="#545454",e.style.visibility=t?"visible":"hidden"}))}n.r(t);var s={},o=(n.r(s),n.d(s,"exportData",(function(){return pe})),n.d(s,"initDefaultData",(function(){return fe})),n.d(s,"getAtoms",(function(){return ge})),n.d(s,"selectedNodes",(function(){return be})),n.d(s,"onlyLook",(function(){return me})),n.d(s,"clean",(function(){return ve})),n.d(s,"autoLayout",(function(){return he})),n.d(s,"getListData",(function(){return Ce})),n.d(s,"confirmChanges",(function(){return ye})),n.d(s,"updateNode",(function(){return _e})),n.d(s,"magicUpdate",(function(){return Oe})),n.d(s,"graphValidate",(function(){return xe})),n.d(s,"GraphListener",(function(){return ke})),n("1394"),n("cbde"),n("5b41"),n("0594"),n("cdd2")),c=n("b210"),i=(t=(o.default.use(c.c),n("42b1"),n("7e10")),Object(t.a)({},(function(){var e=this.$createElement;e=this._self._c||e;return e("div",{attrs:{id:"app"}},[e("router-view")],1)}),[],!1,null,null,null).exports),r=n("e861"),l=n("ca39"),d=n("51b3"),u=(n("b0dd"),n("093e"),n("97e4"),n("891f"),n("1755"),n("27e5"),n("cf67"),n("44c0"),n("25d6"),n("420b"),new o.default),p=(n("9953"),n("4e43")),f=n("191a").a.define({markup:[{tagName:"rect",selector:"button",attrs:{width:20,height:20,rx:10,ry:10,fill:"#ff4d4f",stroke:"#ff4d4f",cursor:"pointer"}},{tagName:"text",selector:"text",textContent:"-",attrs:{fill:"#fff",fontSize:40,textAnchor:"middle",pointerEvents:"none",x:10,y:21},style:{userSelect:"none"}}],onClick:function(e){e=e.view.cell,e.removeTools(),e.remove()}}),g="custom-remove-button",b={CELL_CLICK:"__antv_x6_custom_event_type_cell_click__",NODE_CLICK:"__antv_x6_custom_event_type_node_click__",DOUBLE_NODE_CLICK:"__antv_x6_custom_event_type_cell_double_click__",HELP:"__antv_x6_custom_event_type_help__",FREEZE_GRAPH:"__antv_x6_custom_event_type_freeze_graph__",RUNTIME_ERR:"__antv_x6_custom_event_type_runtime_err__"},m="selected",v="unselected",h="panel_area_slot",C={USERREQUEST:"USERREQUEST",SPEAK:"SPEAK",ASK:"ASK",FOR:"FOR",LOOPEND:"LOOPEND",INFO:"INFO",INFODECLARE:"INFODECLARE",INFOASSIGN:"INFOASSIGN",IF:"IF",END:"END",GOTO:"GOTO",DETECTHUMAN:"DETECTHUMAN"},y=(n("4adf"),{}),_=(n("db45"),Object(t.a)(y,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"container"})}),[],!1,null,"a3aa2112",null).exports),O=function(e){e.on("node:mouseenter",(function(t){t=t.node;var n,s=t.getData(),o=(s=(s&&s.disableMove?a(t,!1):a(t,!0),t.store.data.position),s.x);s=s.y;t.data&&!t.data.initialization&&(n=t.data.tooltip,t=o+100,o=s-50,s=15*n.length,s=n.length<=4?25*n.length:n.length<=6?16*n.length:15*n.length,e.addNode({x:t,y:o,width:s,height:40,shape:"html",html:function(){var e=document.createElement("div");return e.style.border="1px solid #e2e2e2",e.style.borderRadius="4px",e.style.fontSize="12px",e.style.color="#545454",e.style.wordBreak="break-all",e.style.backgroundColor="rgba(255, 255, 255, 0.9)",e.style.boxShadow="rgb(174, 174, 174) 0px 0px 10px",e.style.padding="10px",e.innerText=n,e}}))})),e.on("node:mouseleave",(function(t){t=t.node;a(t,!1),null!=(t=e.getNodes())&&t.forEach((function(t){"html"===t.shape&&e.removeNode(t)}))}))},x=function(e){e.on("cell:removed",(function(){var t;null!=(t=e.getNodes())&&t.forEach((function(t){"html"===t.shape&&e.removeNode(t)}))}))},k=n("97aa"),S=n("e2b1"),w=(n("3971"),n("63cb"),n("f6aa"),function(){function e(){Object(k.a)(this,e)}return Object(S.a)(e,null,[{key:"dispatchEvent",value:function(e,t){if(!e)throw new Error("TypeEnum not found");window.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!1,cancelable:!0}))}},{key:"eventListener",value:function(e,t){if(!e)throw new Error("TypeEnum not found");window.addEventListener(e,(function(e){t(e.detail)}),!1)}}]),e}()),E="",N=function(e){e.on("cell:selected",(function(t){var n;t=t.cell;t.isEdge()&&(t.attr("line",{stroke:"skyblue",strokeWidth:3}),n={distance:"30%"}),t.isNode()&&(e.findView(t).addClass("".concat(t.shape,"-selected")),n={x:-28,y:-5}),w.dispatchEvent(b.CELL_CLICK,m),1<(E=e.getSelectedCells()).length?E.forEach((function(e){e.removeTools()})):t.addTools({name:g,args:n})})),e.on("cell:unselected",(function(t){var n;t=t.cell;t.isEdge()?t.attr("line",{stroke:"#7c68fc",strokeWidth:2}):(n=e.findView(t))&&n.removeClass("".concat(t.shape,"-selected")),t.removeTools(),w.dispatchEvent(b.CELL_CLICK,v),null!=(n=e.getNodes())&&n.forEach((function(t){"html"===t.shape&&e.removeNode(t)}))}))},T=function(e){e.on("edge:connected",(function(t){var n,a,s=t.edge,o=t.currentCell;t=t.currentMagnet.getAttribute("port");o.isNode()&&"vue-shape"===o.shape&&(n=e.findViewByCell(s))&&(n=n.findOne("path"))&&((a=p.k.create("circle",{r:8,fill:"#5F95FF"})).animateAlongPath({dur:"3s",repeatCount:"indefinite"},n),a.appendTo(n.parentNode)),"vue-shape"!==o.shape&&(o.setPortProp(t,"connected",!0),s.zIndex=-1,s.attr({line:{strokeDasharray:"",targetMarker:"classic"}}),s.appendLabel({attrs:{label:{text:""}}}))}))};function j(e){var t=e.data,n=e.data.tooltip;t=(void 0===t?{}:t).actionType;return{node:e,label:n,nodeId:e.id,actionType:t}}function A(e){var t;(t=e).bindKey(["ctrl+c","command+c"],(function(){var e=t.getSelectedCells();return e.length&&t.copy(e),!1})),t.bindKey(["ctrl+v","command+v"],(function(){var e;return t.isClipboardEmpty()||(e=t.paste({offset:32}),t.cleanSelection(),t.select(e)),!1})),t.bindKey(["ctrl+a","command+a"],(function(){var e=t.getCells();return e.length&&t.select(e),!1})),t.bindKey(["delete","backspace"],(function(){var e=t.getSelectedCells();return e.length&&(e.forEach((function(e){e.removeTools()})),t.removeCells(e)),!1}),"keydown"),t.bindKey(["ctrl+z","command+z"],(function(){var e;return null!=t&&null!=(e=t.history)&&e.undo(),!1})),t.bindKey(["ctrl+y","shift+command+z"],(function(){var e;return null!=t&&null!=(e=t.history)&&e.redo(),!1})),t.bindKey("esc",(function(){return t.cleanSelection(),w.dispatchEvent(b.HELP,"close"),!1})),t.bindKey(["alt+h","option+h"],(function(){return w.dispatchEvent(b.HELP),!1})),t.bindKey(["alt+f","option+f"],(function(){return t.centerContent(),!1}))}var I=function(e){e.on("node:click",(function(e){e=j(e.node),w.dispatchEvent(b.NODE_CLICK,e)})),e.on("node:dblclick",(function(t){t=t.node;var n=e.getSelectedCells();p.d.isArray(n)&&1===n.length&&(n=j(t),w.dispatchEvent(b.DOUBLE_NODE_CLICK,n))}))},D={offset:30,useLocalStorage:!0},L=Object(c.g)({graph:null});function P(){return Object(c.a)((function(){return L.graph}))}function M(){var e,t=new p.c({container:document.getElementById("container"),autoResize:!0,keyboard:{enabled:!0,global:!0},selecting:{enabled:!0,showNodeSelectionBox:!0,rubberband:!0,modifiers:"ctrl"},snapline:!0,panning:{enabled:!0,eventTypes:["leftMouseDown","rightMouseDown","mouseWheel"]},grid:{size:10,visible:!0},clipboard:!0,history:{enabled:!0,beforeAddCommand:function(e,t){if(t.key)return"tools"!==t.key}},highlighting:{magnetAvailable:{name:"stroke",args:{padding:1,attrs:{"stroke-width":2,stroke:"green"}}},magnetAdsorbed:{name:"stroke",args:{padding:4,attrs:{"stroke-width":8,stroke:"green"}}}},mousewheel:{enabled:!0,modifiers:["ctrl","meta"]},interacting:function(e){return null==(e=e.cell.getData())||!e.disableMove||{nodeMovable:!1}},connecting:{snap:{radius:50},allowBlank:!1,allowLoop:!1,allowMulti:!1,highlight:!0,anchor:{name:"bottom"},sourceAnchor:{name:"center"},targetAnchor:"top",connectionPoint:"anchor",connector:{name:"rounded",args:{radius:1}},router:{name:"manhattan",args:{step:15,startDirections:["bottom"],endDirections:["top"],padding:10}},validateMagnet:function(e){return"in"!==e.magnet.getAttribute("port-group")},createEdge:function(){return this.createEdge({zIndex:-1,attrs:{line:{strokeDasharray:"5 5",stroke:"#7c68fc",strokeWidth:1,targetMarker:{name:"block",args:{size:"6"}}}}})},validateConnection:function(e){var t=e.targetView,n=e.sourceMagnet,a=e.targetMagnet;e=e.sourceCell;return!(!n||!a)&&((null==(n=e.getData())||!n.disableMove)&&(e=a.getAttribute("port"),!!t.cell.getPort(e)))}}});p.c.registerVueComponent("vue-node",{template:"<vue-node />",components:{VueNode:_}},!0),O(e=t),x(e),N(e),T(e),I(e),A(t),(L.graph=t).on("edge:dblclick",(function(e){var t=e.cell;e=e.e;t.addTools({name:"edge-editor",args:{event:e}})}))}var U=n("99dc"),R=n("47c1"),F=(y=(n("60da"),n("225a"),n("e9e2"),n("af13"),n("7477")),n.n(y));function z(e){var t,n,a;return e=(e=e).split("\n"),t=[],n=[],a={all:[]},e.forEach((function(e){var s=e.match(/(\w+)\(\["(\w+):([^"]+)"\]\)/),o=e.match(/(\w+)\["(\w+):?([^"]*)"\]/),c=e.match(/(\w+)\{\{"(\w+):([^"]+)"\}\}/),i=e.match(/(\w+)\{"(\w+):([^"]+)"\}/),r=null;if(s?r=s:o?r=o:c?r=c:i&&(r=i),r){s=r[1],o=r[2],c=r[3].trim();for(var l=c.split(";"),d=1;d<l.length;d++){var u=l[d];a.all.push(u)}i=new Set(a.all),r=Array.from(i),a.all=r,i=o.toUpperCase(),"condition"==o&&(i="IF"),"forLoop"==o&&(i="FOR"),"loopEnd"==o&&(i="LOOPEND"),r={attrs:{label:{text:c=0==c.length&&"detectHuman"==(c=o)?"人物检测":c}},id:s,data:{actionType:i="end"==o?"END":i,tooltip:c}},t.push(r)}s=e.match(/(\w+)\s-.*->\s(\w+)/),s&&(o="",(i=s[0].match(/(\w+)\s--(.*?)-->\s(\w+)/))&&(o=i[2]),c=s[1],r=s[2],n.push({source:{cell:c,port:"p_bottom",anchor:{name:"center"}},target:{cell:r,port:"p_top",anchor:{name:"center"}},labels:[{attrs:{label:{text:o}}}],attrs:{line:{stroke:"#C0C0C0",strokeWidth:1}}}))})),console.log("mermaid2antV: nodes+edges: ",{nodes:t,edges:n}),console.log("mermaid2antV: variables: ",a),{nodes:t,edges:n,variables:a}}function V(e,t){var n;return t=t,n="graph TB\n",e.forEach((function(e){var t=e.id,a=(console.log("node.data: ",e.data),e.data.actionType),s=e.attrs.label.text,o="";switch(a){case"USERREQUEST":o="".concat(t,'(["userRequest:').concat(s,'"])');break;case"INFODECLARE":o="".concat(t,'["infoDeclare:').concat(s,'"]');break;case"INFOASSIGN":o="".concat(t,'["infoAssign:').concat(s,'"]');break;case"SPEAK":o="".concat(t,'["speak:').concat(s,'"]');break;case"ASK":o="".concat(t,'["ask:').concat(s,'"]');break;case"GOTO":o="".concat(t,'["goto:').concat(s,'"]');break;case"DETECTHUMAN":o="".concat(t,'["detectHuman"]');break;case"IF":o="".concat(t,'{"condition:').concat(s,'"}');break;case"FOR":o="".concat(t,'{{"forLoop:').concat(s,'"}}');break;case"LOOPEND":o="".concat(t,'{{"loopEnd:').concat(s,'"}}');break;case"END":o="".concat(t,'(["end:').concat(s,'"])')}n+="".concat(o,"\n")})),t.forEach((function(e){console.log("con-edge : ",e);var t=e.source.cell,a=e.target.cell,s=(e=0<e.labels.length?e.labels[0].attrs.label.text:"","");s=(0<e.length?"".concat(t," --").concat(e?"".concat(e):"","--\x3e "):"".concat(t," --\x3e ")).concat(a);n+="".concat(s,"\n")})),console.log(n),n}n("80b2"),n("017a"),n("a5e5");var J=n("dfb2");function H(e){try{if(p.d.isString(e))return JSON.parse(e);if(p.d.isArray(e))return e.map((function(e){return p.d.isObject(e)?e:JSON.parse(e)}));if(p.d.isObject(e))return e;throw w.dispatchEvent(b.RUNTIME_ERR,F.a.InvalidFormatData("nodes or edges error")),F.a.InvalidFormatData("nodes or edges error")}catch(e){return{}}}function B(e){return p.d.isString(e)?e.length<=9?e:"user"==e.slice(0,4)||"info"==e.slice(0,4)||"dete"==e.slice(0,4)||"cond"==e.slice(0,4)?e.slice(0,15)+"...":e.slice(0,9)+"...":e}function $(){var e=P().value,t=[],n=[],a=[],s=[];if((e=e.getCells()).length){var o,c=Object(U.a)(e);try{for(c.s();!(o=c.n()).done;){var i=o.value,r=i.toJSON();i.isEdge()&&(a.push(r),t.push(JSON.stringify(r))),i.isNode()&&(r.attrs.label.text=r.data.tooltip,s.push(r),n.push(JSON.stringify(r)))}}catch(e){c.e(e)}finally{c.f()}}return{nodes:n,edges:t,nodesJSON:s,edgesJSON:a}}function K(e){var t,n=P();e?(e=n.value,(t=e.getCells()).length&&t.forEach((function(e){e.removeTools(),e.setData({disableMove:!0})})),e.freeze().disableSelection().disableMultipleSelection().cleanSelection().disableClipboard().disableHistory().disableSnapline().disableKeyboard(),w.dispatchEvent(b.FREEZE_GRAPH,!0)):(t=n.value,(e=t.getCells()).length&&e.forEach((function(e){e.setData({disableMove:!1})})),t.unfreeze().enableSelection().enableMultipleSelection().enableClipboard().enableHistory().enableSnapline().enableKeyboard(),w.dispatchEvent(b.FREEZE_GRAPH,!1))}function G(){return P().value.getNodes().map((function(e){return{attrs:e.attrs,id:e.id,data:e.data}}))}function q(){return P().value.getEdges().map((function(e){return{source:e.source,target:e.target,labels:e.labels,attrs:e.attrs}}))}var W=180,Q=40;function Z(e){var t,n={border:"#4F6C8F",background:"#DEEDFF",left_background:"#4F6C8F"},a={border:"#6D9862",background:"#E7FCE2",left_background:"#6D9862"},s={border:"#CCC74D",background:"#FFFEE0",left_background:"#CCC74D"},o={border:"#B16C9D",background:"#FFEFFB",left_background:"#B16C9D"},c={border:"#969696",background:"#D9D9D9",left_background:"#969696"};if(!e)return{border:"#939393",background:"#83b7ff",left_background:"#83b7ff"};var i=C.USERREQUEST,r=C.SPEAK,l=C.ASK,d=C.FOR,u=C.LOOPEND,p=C.IF,f=C.INFO,g=C.INFODECLARE,b=C.INFOASSIGN,m=C.END,v=C.GOTO,h=C.DETECTHUMAN;t={},Object(R.a)(t,i,s),Object(R.a)(t,r,n),Object(R.a)(t,l,n),Object(R.a)(t,d,o),Object(R.a)(t,u,o),Object(R.a)(t,p,o),Object(R.a)(t,f,a),Object(R.a)(t,g,a),Object(R.a)(t,b,a),Object(R.a)(t,v,n),Object(R.a)(t,m,s),Object(R.a)(t,h,n),Object(R.a)(t,"default",c),i=t;return i[e]||i.default}function X(e){var t,n=e.x,a=e.y,s=e.id,o=e.data,c=e.attrs,i=(e=e.actionType,o&&(e=o.actionType),W),r=Q;return p.d.isObject(c)&&(t=c.label.text),o.tooltip||(o.tooltip=t),{x:n,y:a,label:B(t),width:i,height:r,id:s,data:{actionType:e,tooltip:o.tooltip}}}function Y(e){e=X(e);var t=e.x,n=e.y,a=e.label,s=e.id,o=e.data,c=e.width,i=(e=e.height,o.actionType),r=Z(i);i=function(e){var t="http://192.168.123.70:5500/packages/icons/UserRequest.png",n="http://192.168.123.70:5500/packages/icons/speak.png",a="http://192.168.123.70:5500/packages/icons/ask.png",s="http://192.168.123.70:5500/packages/icons/goto.png",o="http://192.168.123.70:5500/packages/icons/forLoop.png",c="http://192.168.123.70:5500/packages/icons/loopEnd.png",i="http://192.168.123.70:5500/packages/icons/condition.png",r="http://192.168.123.70:5500/packages/icons/var.png",l="http://192.168.123.70:5500/packages/icons/infoDeclare.png",d="http://192.168.123.70:5500/packages/icons/infoAssign.png",u="http://192.168.123.70:5500/packages/icons/detectHuman.png",p="http://192.168.123.70:5500/packages/icons/end.png";if(!e)return"http://192.168.123.70:5500/packages/icons/UserRequest.png";var f=C.USERREQUEST,g=C.SPEAK,b=C.ASK,m=C.FOR,v=C.LOOPEND,h=C.IF,y=C.INFO,_=C.INFODECLARE,O=C.INFOASSIGN,x=C.END,k=C.GOTO,S=C.DETECTHUMAN,w={};return Object(R.a)(w,f,t),Object(R.a)(w,g,n),Object(R.a)(w,b,a),Object(R.a)(w,m,o),Object(R.a)(w,v,c),Object(R.a)(w,h,i),Object(R.a)(w,y,r),Object(R.a)(w,_,l),Object(R.a)(w,O,d),Object(R.a)(w,k,s),Object(R.a)(w,x,p),Object(R.a)(w,S,u),w[e]}(i);return{id:s,shape:"rect",width:c,height:e,x:t,y:n,data:o,attrs:{body:{stroke:r.border,strokeWidth:2,fill:r.background,rx:5,ry:5},leftRect:{x:2,y:2,width:38,height:36,stroke:r.border,strokeWidth:2.5,fill:r.left_background},icon:{x:6,y:6,width:28,height:28,xlinkHref:i},label:{text:a,fill:"#000000",fontSize:12,fontWeight:"bold",x:-38,"text-anchor":"start"}},markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"leftRect"},{tagName:"image",selector:"icon"},{tagName:"text",selector:"label"}],ports:{items:[{group:"port_top",id:"p_top"},{group:"port_bottom",id:"p_bottom"}],groups:{port_top:{position:"top",zIndex:20,attrs:{circle:{dataClass:"choice-point",r:8,magnet:!0,stroke:"#5b8ffa",strokeWidth:1,fill:"#fff"}}},port_bottom:{position:"bottom",zIndex:20,attrs:{circle:{dataClass:"choice-point",r:8,magnet:!0,stroke:"#5b8ffa",strokeWidth:1,fill:"#fff"}}}}}}}function ee(e,t,n){if(!p.d.isArray(t)||!p.d.isArray(n))throw w.dispatchEvent(b.RUNTIME_ERR,F.a.InvalidParameters("节点或者边数据格式不正确")),new F.a.InvalidParameters("节点或者边数据格式不正确");e.fromJSON({nodes:function(e){var t,n=[],a=Object(U.a)(e);try{for(a.s();!(t=a.n()).done;){var s=H(t.value);if(!s.data.actionType)throw w.dispatchEvent(b.RUNTIME_ERR,F.a.InvalidFormatData("缺少ActionType")),new F.a.InvalidFormatData("缺少ActionType");n.push(Y(s))}}catch(e){a.e(e)}finally{a.f()}return n}(t),edges:H(n)})}n("77ab");y=Object(t.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"container"},[this._v("Vue-node")])}),[],!1,null,"506062a8",null).exports;var te=n("9da1"),ne=n("e3c6");n("8cdd");var ae=new(function(){function e(){Object(k.a)(this,e),this.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var t;return Object(S.a)(e,[{key:"recording",value:(t=Object(ne.a)(Object(te.a)().mark((function e(t,n){var a;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/recording"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionID:this.id,type:t,content:n})});case 2:return a=e.sent,e.next=5,a.text().then((function(e){return console.log("data",e),e}));case 5:a=e.sent,console.log("logRecoding:",a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}());ae.recording("start","start a new session");y=Object(c.d)({props:["nodes"],components:{VueNode:y},methods:{imagePath:function(e){return"http://192.168.123.70:5500/packages/icons/"+(e={"服务启动词":"userRequest","说话":"speak","询问":"ask","前往":"goto","人物检测":"detectHuman","判断":"condition","循环":"forLoop","退出循环":"loopEnd","创建变量":"infoDeclare","变量赋值":"infoAssign","服务结束":"end"}[e])+".png"}},setup:function(){var e=P(),t=Object(c.g)({dnd:{},freeze:!1}),n={startDrag:function(n,a){var s=n.actionType,o=n.shape;n=n.label,console.log("currentTarget: ",{actionType:s,shape:o,label:n}),o=Y({shape:o,tooltip:n="detectHuman"==n?"人物检测":n,attrs:{label:{text:n}},data:{actionType:s},initialization:!0}),console.log("startDrag: nodeJson: ",o),n=e.value.createNode(o);console.log("startDrag: node: ",n),t.freeze||t.dnd.start(n,a),ae.recording("newNodeAdd",n)},initDnd:function(){t.dnd=new p.a.Dnd({target:e.value,validateNode:function(){return!0}})}};return Object(c.i)((function(){return e.value}),n.initDnd),w.eventListener(b.FREEZE_GRAPH,(function(e){t.freeze=e})),Object(l.a)(Object(l.a)({},Object(c.h)(t)),n)}}),n("8b97"),y=Object(t.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-bar-container"},[n("span",{staticClass:"nodes-bar-title"},[e._v("组件库")]),n("ul",{staticClass:"nodes-bar"},e._l(e.nodes,(function(t,a){return n("li",{key:a},[n("div",{class:[e.freeze?"freeze-"+t.shape:"default-"+t.shape],style:t.styles,attrs:{id:"container_node"},on:{mousedown:function(n){return e.startDrag(t,n)}}},[n("img",{staticClass:"icon",attrs:{src:e.imagePath(t.label)}}),n("div",{staticClass:"content"},[n("span",[e._v(e._s(t.label))])])])])})),0)])}),[],!1,null,"aa7255c0",null).exports;var se=(n("6ba9"),Object(t.a)({},(function(){this.$createElement;return this._self._c,this._m(0)}),[function(){var e=this.$createElement;e=this._self._c||e;return e("div",{staticClass:"panel-area-container"},[e("div",{attrs:{id:"minimap"}})])}],!1,null,"6bb2b964",null).exports),oe=(n("084c"),Object(c.d)({name:"svg-icon",props:{title:{type:String,default:""},iconClass:{type:String,required:!0},className:{type:String,default:""}},setup:function(e){return{iconName:Object(c.a)((function(){return"#icon-".concat(e.iconClass)})),svgClass:Object(c.a)((function(){return e.className?"svg-icon "+e.className:"svg-icon"}))}}})),ce=(oe=(n("bde3"),Object(t.a)(oe,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("svg",e._g({class:e.svgClass,attrs:{"aria-hidden":"true"}},e.$listeners),[t("title",[e._v(e._s(e.title))]),t("use",{attrs:{"xlink:href":e.iconName}})])}),[],!1,null,"487b043a",null).exports),{undo:{svg:"undo",can:!1,title:"撤销"},redo:{svg:"redo",can:!1,title:"重做"},zoomin:{svg:"zoomin",title:"放大"},zoomout:{svg:"zoomout",title:"缩小"},copy:{svg:"copy",title:"复制"},delete:{svg:"dustbin",title:"删除",can:!1},focus:{svg:"focus",title:"居中"},selectAll:{svg:"select_all",title:"全选"},selectCancel:{svg:"select_cancel",title:"取消选中"}}),ie=[{label:"Ctrl+a",value:"单元全选"},{label:"Ctrl+c",value:"单元复制"},{label:"Ctrl+v",value:"单元粘贴"},{label:"Delete / BackSpace",value:"单元删除"},{label:"Ctrl+z",value:"单元撤销"},{label:"Ctrl+y",value:"单元重做"},{label:"Esc",value:"取消所有选中单元"},{label:"Alt+h",value:"帮助信息"},{label:"Alt+f",value:"画布居中"},{label:"Ctrl+mouseWheel",value:"放大/缩小"},{label:"Ctrl+leftMouseDown",value:"框选"}],re=(oe=Object(c.d)({components:{SvgIcon:oe},setup:function(){var e=P(),t=Object(c.g)({showTips:!1,timeId:null,freeze:!1,tools:ce,tipsContent:ie}),n={handleTipsHover:function(){t.showTips=!0,clearTimeout(t.timeId)},handleTipsLeave:function(){t.timeId=setTimeout((function(){t.showTips=!1,t.timeId=null}),0<arguments.length&&void 0!==arguments[0]?arguments[0]:500)},handleTrigger:function(n){switch(n){case"undo":case"redo":t.tools[n].can&&e.value.history[n]();break;case"zoomin":e.value.zoom(.1);break;case"zoomout":e.value.zoom(-.1);break;case"copy":o=e.value,(c=null==o?void 0:o.getSelectedCells())&&c.length&&o.copy(c,D),o.isClipboardEmpty()||(c=o.paste(D),o.cleanSelection(),o.select(c));break;case"dustbin":o=e.value,(c=o.getSelectedCells()).length&&(c.forEach((function(e){e.removeTools()})),o.removeCells(c));break;case"focus":e.value.centerContent();break;case"select_all":a=e.value,(s=a.getCells()).length&&a.select(s);break;case"select_cancel":a=e.value,console.log("取消选中"),a.cleanSelection()}var a,s,o,c}};return Object(c.f)((function(){w.eventListener(b.CELL_CLICK,(function(e){var n=m;t.tools.delete.can=e===n})),w.eventListener(b.HELP,(function(e){t.showTips="close"!==e,t.showTips&&n.handleTipsLeave(3e4)})),setTimeout((function(){var n=e.value.history;n.on("change",(function(){t.tools.undo.can=n.canUndo(),t.tools.redo.can=n.canRedo()}))}),1e3),w.eventListener(b.FREEZE_GRAPH,(function(e){for(var n in t.freeze=e,t.tools)Object.hasOwnProperty.call(t.tools,n)&&(n=t.tools[n],["undo","redo","copy","select_all"].includes(n.svg)&&(n.freeze=e))}))})),Object(l.a)(Object(l.a)({},Object(c.h)(t)),n)}}),oe=(n("b423"),Object(t.a)(oe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"toolbar-container"},[e._l(e.tools,(function(t,a){return n("svg-icon",{key:a,staticClass:"icon",class:["can"in t&&!t.can?"disabled":"enabled",{freeze:t.freeze}],attrs:{"icon-class":t.svg,title:t.title},on:{click:function(n){return e.handleTrigger(t.svg)}}})})),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!e.freeze,expression:"!freeze"}],staticClass:"icon tips",class:{light:e.showTips},attrs:{"icon-class":"tips",title:"提示"},on:{mouseenter:e.handleTipsHover,mouseleave:e.handleTipsLeave}}),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showTips,expression:"showTips"}],staticClass:"tips-container",on:{mouseenter:e.handleTipsHover,mouseleave:e.handleTipsLeave}},[e._l(e.tipsContent,(function(t,a){return n("div",{key:a,staticClass:"tips-row"},[n("div",{staticClass:"label"},[e._v(e._s(t.label))]),n("div",{staticClass:"value"},[e._v(e._s(t.value))])])})),n("div",{staticClass:"arrow"})],2)])],2)}),[],!1,null,"08024ed4",null).exports),{width:"110px",height:"35px",lineHeight:"30px",textAlign:"center",border:"2px solid",borderRadius:"5px"});function le(e){var t=re;e=Z(e);return Object(l.a)(Object(l.a)({},t),{},{backgroundColor:e.left_background,borderColor:e.border})}var de=[{label:"服务启动词",actionType:C.USERREQUEST,styles:le(C.USERREQUEST)},{label:"说话",actionType:C.SPEAK,styles:le(C.SPEAK)},{label:"询问",actionType:C.ASK,styles:le(C.ASK)},{label:"前往",actionType:C.GOTO,styles:le(C.GOTO)},{label:"人物检测",actionType:C.DETECTHUMAN,styles:le(C.DETECTHUMAN)},{label:"判断",actionType:C.IF,styles:le(C.IF)},{label:"循环",actionType:C.FOR,styles:le(C.FOR)},{label:"退出循环",actionType:C.LOOPEND,styles:le(C.LOOPEND)},{label:"创建变量",actionType:C.INFODECLARE,styles:le(C.INFODECLARE)},{label:"变量赋值",actionType:C.INFOASSIGN,styles:le(C.INFOASSIGN)},{label:"服务结束",actionType:C.END,styles:le(C.END)}],ue=(y=Object(c.d)({name:"AntvX6Vue2",components:{NodesBar:y,PanelArea:se,Toolbar:oe},setup:function(e,t){var n=t.emit;t=Object(c.g)({nodes:de,panelAreaName:h});return w.eventListener(b.NODE_CLICK,(function(e){return n("node-click",e)})),w.eventListener(b.DOUBLE_NODE_CLICK,(function(e){return n("node-dblclick",e)})),Object(c.f)((function(){p.c.registerNodeTool(g,f,!0),p.c.registerEdgeTool(g,f,!0),M()})),Object(l.a)({},Object(c.h)(t))}}),n("332d"),Object(t.a)(y,(function(){var e=this.$createElement;e=this._self._c||e;return e("div",{staticClass:"graph-container"},[e("div",{staticClass:"layout"},[e("div",{staticClass:"left-node-bar-container"},[e("NodesBar",{attrs:{nodes:this.nodes}})],1),e("div",{staticClass:"graph-main-container",attrs:{id:"container"}})])])}),[],!1,null,null,null).exports),pe=(se=(n("728e"),ue.install=function(e){e.component(ue.name,ue)},ue),$),fe=function(e,t){e=e,t=t,ee(P().value,e,t)},ge=function(e){var t;switch(e){case"nodes":t={nodes:G()};break;case"edges":t={edges:q()};break;default:t={nodes:G(),edges:q()}}return t},be=function(){return P().value.getSelectedCells().length},me=K,ve=function(){var e,t;e=P(),(t=e.value.getCells()).length&&(t.forEach((function(e){e.removeTools()})),e.value.removeCells(t))},he=function(e,t){var n;e=e,t=t,n=P(),e={nodes:e,edges:t},t=new J.a({type:"dagre",rankdir:"TB",align:"DL",ranksep:25,nodesep:50,controlPoints:!0}).layout(e),ee(n.value,t.nodes,t.edges)},Ce=z,ye=V,_e=function(e){var t,n,a,s;e=e,console.log("updateNode.data: ",e.label,e.name,e.tooltip),a=P(),s=a.value.getSelectedCells(),p.d.isArray(s)&&1===s.length&&(s=s[0],t=e.label,n=e.name,e=e.tooltip,console.log("label: ---",t,n,e),t&&(n=B(t),s.setData({tooltip:t,initialization:!1}),s.setAttrs({label:{text:n}})),a.value.cleanSelection())},Oe=function(){return P().value.getSelectedCells()},xe=function(){var e,t=P(),n=[],a=(t.value.getCells().length||n.push("画布无可用节点"),t.value.getEdges()),s=(a=new Set(a.reduce((function(e,t){return e.push(t.target.cell),e.push(t.source.cell),e}),[])),t=t.value.getNodes(),a.size!==t.length&&n.push("存在未连线的节点"),C.USERREQUEST),o=0,c=0,i=Object(U.a)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value.getData(),l=r.initialization,d=r.tooltip,u=r.actionType;l&&n.push("[".concat(d||"","]节点数据不能为空")),u===s?o+=1:c+=1}}catch(e){i.e(e)}finally{i.f()}return o&&c||n.push("流程链路未闭环"),{ok:!n.length,errs:n}},ke=function(){function e(){Object(k.a)(this,e)}return Object(S.a)(e,null,[{key:"doubleNodeClick",value:function(e){var t;t=e,console.log("index.js--nodeDClick"),w.eventListener(b.DOUBLE_NODE_CLICK,(function(e){return t(e)}))}},{key:"nodeClick",value:function(e){var t;t=e,console.log("index.js--nodeClick"),w.eventListener(b.NODE_CLICK,(function(e){return t(e)}))}},{key:"runtimeError",value:function(e){var t;t=e,w.eventListener(b.RUNTIME_ERR,(function(e){return t(e)}))}}]),e}(),Se=[se];function we(e){e.use(c.c),Se.forEach((function(t){e.component(t.name,t)}))}"undefined"!=typeof window&&window.Vue&&we(window.Vue);oe={install:we};var Ee=n("8622"),Ne=(y=n.n(Ee),[]),Te=(se=Object(c.d)({setup:function(){var e=Object(c.g)({isMenuOpen:!1,selectedOptions:[],disabled:!1,currentIndex:0,isUpdate:!1,isSelected:!1,isSpeakSelected:!1,isAskSelected:!1,isIfSelected:!1,isGotoSelected:!1,isDetectHumanSelected:!1,isEndSelected:!1,isLoopEndSelected:!1,isUserRequestSelected:!1,isForSelected:!1,isInfoDeclareSelected:!1,isInfoAssignSelected:!1,title:"",form:{label:"",name:"",tooltip:"",variable:"",action:""},variables:{all:["21"]},gotoVariables:["接待区","会议室","员工办公区","领导办公室","创作室","健身房","会客厅","茶水间"],titleData:{title:"X6 示例标题"},VUE_APP_ICON_Server:"http://192.168.123.70:5500"}),t={showOptions:function(){console.log("show: ",0<s.selectedNodes()),e.isSelected=0<s.selectedNodes()}},n={handleNodeClick:function(t){console.log("[debug]节点单击Emit事件:",t),e.isSelected=!1,e.isSpeakSelected=!1,e.isAskSelected=!1,e.isIfSelected=!1,e.isGotoSelected=!1,e.isDetectHumanSelected=!1,e.isEndSelected=!1,e.isLoopEndSelected=!1,e.isUserRequestSelected=!1,e.isForSelected=!1,e.isInfoDeclareSelected=!1,e.isInfoAssignSelected=!1,e.isMenuOpen=!1,ae.recording("nodeClick",t.label)},handleExportAtoms:function(){var e=s.getAtoms();console.log("[debug]data:",e),Ee.Message.success("Please view it on the console")},handleExport:function(){var e,t=s.graphValidate(),n=t.ok;t=t.errs;n?(e=(n=s.exportData()).nodesJSON,n=n.edgesJSON,console.log("[debug]nodesJSON:",e),console.log("[debug]edgesJSON:",n),Ee.Message.success("Export succeeded. Please view it on the console")):(console.log("[debug]errs:",t),Ee.Message.error(t[0]))},handleOnlyLook:function(){e.disabled=!e.disabled,s.onlyLook(e.disabled)},switchData:function(){var t=Ne[e.currentIndex++];return e.currentIndex>Ne.length-1&&(e.currentIndex=0),t},handleSwitchDefault:function(){var e=n.switchData(),t=e.nodes;e=e.edges;s.autoLayout(t,e)},handleClean:function(){s.clean()},handleTestError:function(){Ee.Message.error("Please view it on the console"),s.initDefaultData()},handleUpdateLabel:function(){e.isMenuOpen=!1,console.log("handleUpdateLabel: ",e.form),"SPEAK"!=e.form.name&&"ASK"!=e.form.name&&"IF"!=e.form.name&&"INFOASSIGN"!=e.form.name||(e.form.label=e.form.action+";"+e.form.variable),console.log("handleUpdateLabel: ",e.form.label),s.updateNode(e.form),e.form.label="",e.isUpdate=!0,ae.recording("Node update",e.form),Ee.Message.success("节点内容修改成功！")},handleAutoLayout:function(){console.log("auto Layout！");var e=s.getAtoms(),t=e.nodes;e=e.edges;s.autoLayout(t,e),ae.recording("AutoLayout","自动布局"),Ee.Message.success("自动布局已完毕！")},handleConfirmChanges:function(){var t,n=s.graphValidate(),a=n.ok;n=n.errs;a?(t=(a=s.exportData()).nodesJSON,a=a.edgesJSON,Ne=[{nodes:t,edges:a}],t=s.confirmChanges(t,a),u.$emit("send-new-mermaid-data",t),Ee.Message.success("确认所有修改，生成新的服务流程！"),document.getElementById("emitTitleToParent").click(),e.isUpdate=!1):console.log("[debug]errs:",n)},handleMagicUpdate:function(){var e=s.magicUpdate();console.log("selectedCells: ",e),1<=e.length?(u.$emit("magic-selected-cells",e),Ee.Message.success("节点调试实施成功，将生成该节点的文字解释！")):Ee.Message.success("节点调试失败...")},getData:function(){var t=s.getListData(0<arguments.length&&void 0!==arguments[0]?arguments[0]:'graph TB\n  r_01(["userRequest:预约开会"])\n  id_01["infoDeclare:用户回复，地点，目标成员"]\n  a_01["ask:询问用户想找哪个实验室成员开会"]\n  ia_01["infoAssign:将用户回复赋值为目标成员;目标成员"]\n  g_01["goto:目标成员的座位"]\n  d_01["detectHuman"]\n  c_01{"condition: 检测到人;人员检测结果1"}\n  a_02["ask:询问目标成员是否有时间参会;目标成员"]\n  ia_02["infoAssign:将用户回复赋值为是否有时间;用户回复1"]\n  c_02{"condition: 目标成员有时间参会;用户回复1"}\n  a_03["ask:询问目标成员想在哪里开会"]\n  ia_03["infoAssign:将用户回复赋值为地点;地点"]\n  ia_04["infoAssign:将目标成员有时间开会，他选择的地点是地点赋值为用户回复;用户回复"]\n  ia_05["infoAssign:将目标成员没有时间开会赋值为用户回复;用户回复"]\n  s_01["speak:感谢目标成员的回复"]\n  ia_06["infoAssign:将目标成员不在座位上赋值为用户回复;用户回复"]\n  g_02["goto:客厅"]\n  s_02["speak:告知用户预约结果;用户回复"]\n  k_01(["end:服务结束"])\n\n  r_01 --\x3e id_01 \n  id_01 --\x3e a_01\n  a_01 --\x3e ia_01\n  ia_01 --\x3e g_01\n  g_01 --\x3e d_01\n  d_01 --\x3e c_01\n  c_01 --true--\x3e a_02\n  a_02 --\x3e ia_02\n  ia_02 --\x3e c_02\n  c_02 --true--\x3e a_03\n  a_03 --\x3e ia_03\n  ia_03 --\x3e ia_04\n  c_02 --false--\x3e ia_05\n  ia_04 --\x3e s_01\n  ia_05 --\x3e s_01\n  c_01 --false--\x3e ia_06\n  ia_06 --\x3e s_01\n  s_01 --\x3e g_02\n  g_02 --\x3e s_02\n  s_02 --\x3e k_01'),n=t.nodes,a=t.edges;t=t.variables;Ne=[{nodes:n,edges:a}],console.log("list:",Ne),e.variables.all=t.all,e.gotoVariables=Object(d.a)(new Set([].concat(Object(d.a)(e.gotoVariables),Object(d.a)(e.variables.all))))},getTitle:function(){e.title=Ne[0].nodes[0].attrs.label.text;for(var t=0;t<Ne[0].length;t++)"USERREQUEST"==Ne[0].nodes[t].data.actionType&&(e.title=Ne[0].nodes[t].attrs.label.text);console.log("gettitle: ",e.title);var n=e.title;u.$emit("send-new-title",n)},variablesMenu:function(){this.isMenuOpen=!this.isMenuOpen},computedValue:function(){return this.form.label.replace(this.form.variable,"")},confirmAddVariable:function(){"GOTO"==e.form.name||"FORLOOP"==e.form.name?e.form.label=this.selectedOptions:(this.selectedOptions=this.selectedOptions.join(";"),0!=e.form.variable.length?e.form.variable=e.form.variable+";"+this.selectedOptions:e.form.variable=e.form.variable+this.selectedOptions),this.selectedOptions=[],console.log("data.form.variable: ",e.form.variable),ae.recording("Node update -- variable",e.form),Ee.Message.success("变量修改成功！"),e.isMenuOpen=!1},emitTitleToParent:function(){e.titleData.title=Ne[0].nodes[0].attrs.label.text,this.$emit("title-to-parent",this.titleData.title)},listener:function(){s.GraphListener.doubleNodeClick((function(t){if(console.log("detail: ",t.node.data),e.form.variable="",e.form.action="",e.form.tooltip=t.node.data.tooltip,e.form.label=t.label,e.form.name=t.node.data.actionType,e.form.label)if("goto"==e.form.label)e.form.variable="接待区 会议室 开放办公空间 管理员办公室 教师办公室 小莉的座位 数字媒体创作室 健身房 会客厅 茶水间 展陈区 开放办公空间";else{var n=e.form.label.split(";");e.form.action=n[0];for(var a=1;a<n.length;a++)e.form.variable=e.form.variable+" "+n[a]}console.log("data.form: ",e.form),"SPEAK"==e.form.name&&(e.isSpeakSelected=!0),"ASK"==e.form.name&&(e.isAskSelected=!0),"GOTO"==e.form.name&&(e.isGotoSelected=!0),"IF"==e.form.name&&(e.isIfSelected=!0),"DETECTHUMAN"==e.form.name&&(e.isDetectHumanSelected=!0),"FOR"==e.form.name&&(e.isForSelected=!0),"END"==e.form.name&&(e.isEndSelected=!0),"USERREQUEST"==e.form.name&&(e.isUserRequestSelected=!0),"LOOPEND"==e.form.name&&(e.isLoopEndSelected=!0),"INFODECLARE"==e.form.name&&(e.isInfoDeclareSelected=!0),"INFOASSIGN"==e.form.name&&(e.isInfoAssignSelected=!0),e.isSelected=!0,console.log("[debug]detail:",t)})),s.GraphListener.nodeClick((function(t){console.log("单击detail: ",t),1<=s.magicUpdate().length?e.isSelected=!0:e.isSelected=!1})),s.GraphListener.runtimeError((function(e){console.log("[debug]errorCode, errorMsg:",e.errorCode,e.errorMsg)}))}};return Object(c.f)((function(){n.getData(),n.getTitle(),n.handleSwitchDefault(),n.listener(),t.showOptions(),document.getElementById("emitTitleToParent").click(),u.$on("callGetData",(function(e){n.getData(e),n.handleSwitchDefault(),document.getElementById("emitTitleToParent").click()}))})),Object(l.a)(Object(l.a)(Object(l.a)({},Object(c.h)(e)),n),t)}}),se=(n("2d94"),Object(t.a)(se,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"graph-container"},[n("antv-x6-vue2",{ref:"graphContainer",on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"panel_area_slot",fn:function(t){var a=t.row;return n("div",{},[n("el-form-item",{attrs:{label:"Label:"}},[n("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:a.label,callback:function(t){e.$set(a,"label",t)},expression:"row.label"}})],1)],1)}}])})],1),n("div",{staticClass:"right-buttons"},[n("button",{staticClass:"auto-layout-button",on:{click:e.handleAutoLayout}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/autoLayout.png"}})]),n("span",{staticClass:"rightButtonLabel"},[e._v("自动布局")]),e.isSelected?n("button",{staticClass:"redo-button",on:{click:e.handleMagicUpdate}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/redo.png"}})]):e._e(),e.isSelected?e._e():n("button",{staticClass:"redo-button redo-button-unselected"},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/redo.png"}})]),n("span",{staticClass:"rightButtonLabel"},[e._v("节点调试")]),n("button",{staticClass:"ok-button",on:{click:e.handleConfirmChanges}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/ok.png"}})]),n("span",{staticClass:"rightButtonLabel"},[e._v("同步修改")]),n("button",{attrs:{id:"emitTitleToParent"},on:{click:e.emitTitleToParent}})]),e.isSpeakSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name"},[e._v("说话")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("引用变量")]),n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.variable,callback:function(t){e.$set(e.form,"variable",t)},expression:"form.variable"}})],1),n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("行为描述")]),n("el-input",{staticClass:"update-input",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.variables.all,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectedOptions)?-1<e._i(e.selectedOptions,t):e.selectedOptions},on:{change:function(n){var a,s,o=e.selectedOptions,c=(n=n.target,!!n.checked);Array.isArray(o)?(s=e._i(o,a=t),n.checked?s<0&&(e.selectedOptions=o.concat([a])):-1<s&&(e.selectedOptions=o.slice(0,s).concat(o.slice(s+1)))):e.selectedOptions=c}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isAskSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name"},[e._v("询问")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("引用变量")]),n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.variable,callback:function(t){e.$set(e.form,"variable",t)},expression:"form.variable"}})],1),n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("行为描述")]),n("el-input",{staticClass:"update-input",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.variables.all,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectedOptions)?-1<e._i(e.selectedOptions,t):e.selectedOptions},on:{change:function(n){var a,s,o=e.selectedOptions,c=(n=n.target,!!n.checked);Array.isArray(o)?(s=e._i(o,a=t),n.checked?s<0&&(e.selectedOptions=o.concat([a])):-1<s&&(e.selectedOptions=o.slice(0,s).concat(o.slice(s+1)))):e.selectedOptions=c}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isIfSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name node-name-if"},[e._v("判断")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("引用变量")]),n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.variable,callback:function(t){e.$set(e.form,"variable",t)},expression:"form.variable"}})],1),n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("判断条件")]),n("el-input",{staticClass:"update-input",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.variables.all,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectedOptions)?-1<e._i(e.selectedOptions,t):e.selectedOptions},on:{change:function(n){var a,s,o=e.selectedOptions,c=(n=n.target,!!n.checked);Array.isArray(o)?(s=e._i(o,a=t),n.checked?s<0&&(e.selectedOptions=o.concat([a])):-1<s&&(e.selectedOptions=o.slice(0,s).concat(o.slice(s+1)))):e.selectedOptions=c}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isGotoSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name"},[e._v("前往")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.gotoVariables,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"radio"},domProps:{value:t,checked:e._q(e.selectedOptions,t)},on:{change:function(n){e.selectedOptions=t}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isDetectHumanSelected?n("div",{staticClass:"options-container options-container-end"},[n("span",{staticClass:"node-name"},[e._v("人物检测")])]):e._e(),e.isEndSelected?n("div",{staticClass:"options-container options-container-end"},[n("span",{staticClass:"node-name node-name-end"},[e._v("服务结束")])]):e._e(),e.isLoopEndSelected?n("div",{staticClass:"options-container options-container-loop-end"},[n("span",{staticClass:"node-name node-name-loop-end"},[e._v("退出循环")])]):e._e(),e.isUserRequestSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name node-name-user-request"},[e._v("服务启动词")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("el-input",{staticClass:"update-input-goto",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isForSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name node-name-for"},[e._v("循环")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("遍历")]),n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.variables.all,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"radio"},domProps:{value:t,checked:e._q(e.selectedOptions,t)},on:{change:function(n){e.selectedOptions=t}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isInfoDeclareSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name node-name-info-declare"},[e._v("创建变量")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("变量名称")]),n("el-input",{staticClass:"update-input-goto",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e(),e.isInfoAssignSelected?n("div",{staticClass:"options-container"},[n("span",{staticClass:"node-name node-name-info-assign"},[e._v("变量赋值")]),n("div",{staticClass:"middle-box"},[n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("引用变量")]),n("el-input",{staticClass:"update-input-yinyong",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.variable,callback:function(t){e.$set(e.form,"variable",t)},expression:"form.variable"}})],1),n("div",{staticClass:"middle-box-content"},[n("span",{staticClass:"node-name"},[e._v("变量操作")]),n("el-input",{staticClass:"update-input",attrs:{clearable:"",disabled:!e.isSelected},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleUpdateLabel.apply(null,arguments)}},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1)]),n("button",{staticClass:"bottom-button",on:{click:e.variablesMenu}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/{a}.png"}})]),e.isMenuOpen?n("div",{staticClass:"menu"},[n("button",{staticClass:"close-button",on:{click:e.confirmAddVariable}},[e._v("确认添加")]),n("ul",{staticClass:"menu-list"},e._l(e.variables.all,(function(t){return n("li",{key:t,staticClass:"menu-item"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedOptions,expression:"selectedOptions"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectedOptions)?-1<e._i(e.selectedOptions,t):e.selectedOptions},on:{change:function(n){var a,s,o=e.selectedOptions,c=(n=n.target,!!n.checked);Array.isArray(o)?(s=e._i(o,a=t),n.checked?s<0&&(e.selectedOptions=o.concat([a])):-1<s&&(e.selectedOptions=o.slice(0,s).concat(o.slice(s+1)))):e.selectedOptions=c}}}),e._v(" "+e._s(t)+" ")])])})),0)]):e._e(),n("button",{staticClass:"bottom-button",on:{click:e.handleUpdateLabel}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/yes.png"}})])]):e._e()])}),[],!1,null,"5ffc4fee",null).exports),n("a6b8"),n("60be"),n("3fc9"),0),je=1,Ae=2,Ie={data:function(){return{userInput:"",messages:[],messageCounter:0,systemMsg:"",historyMsg:[],currentMsg:"",currentJSCode:"",currentFlowCode:"",newMermaidData:"",selectedCells:[],currentStage:Te,currentSeletecNodes:[],authoringChat:[],serviceGoal:"",serviceReuqirements:"",VUE_APP_ICON_Server:"http://192.168.123.70:5500"}},methods:{sendMessage:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n,a,s,o;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e.userInput.trim())return t.abrupt("return");t.next=2;break;case 2:if(e.userInput=e.userInput.replace(/\n$/,""),console.log("userInput: ",e.userInput),n=e.userInput,e.addMessage(n,"user"),e.userInput="",e.currentStage==Te)return e.addMessage("正在理解...","assistant"),e.authoringChat.push({role:"user",content:n}),t.next=12,e.authoringNEW(e.authoringChat);t.next=19;break;case 12:a=t.sent,console.log("【authoringNEW result】",a),e.authoringChat.push({role:"assistant",content:a}),e.authoringMsgHandler(a),e.scrollToButton(),t.next=45;break;case 19:if(e.currentStage==je)return e.addMessage("正在理解....","assistant"),t.next=23,e.NL2JSwithContext(n,e.currentJSCode);t.next=44;break;case 23:return a=t.sent,s=e.currentJSCode,e.currentJSCode=a,t.next=28,e.ExplainModifiedJS(s,a);case 28:return s=t.sent,e.messages[e.messages.length-1].content=s,e.scrollToButton(),e.addMessage("正在绘制定制服务的流程图，请稍候。","assistant"),t.next=35,e.js2flow(e.currentJSCode);case 35:o=t.sent,e.currentFlowCode=o,console.log("修改后的currentFlowCode: ",e.currentFlowCode),u.$emit("callGetData",e.currentFlowCode),e.messages[e.messages.length-1].content="已重新绘制流程图，你可以继续提出你的服务流程修改需求，我会帮助你进行修改。",e.scrollToButton(),t.next=45;break;case 44:e.currentStage==Ae&&(console.log("magic modify time!"),e.magicModifyIT(n));case 45:setTimeout((function(){e.resizeTextarea({target:e.$refs.textarea})}),100);case 46:case"end":return t.stop()}}),t)})))()},authoringMsgHandler:function(e){e=(new DOMParser).parseFromString(e,"text/xml");var t=e.documentElement.nodeName,n=e.documentElement.textContent,a=this.messages[this.messages.length-1];switch(t){case"require":this.serviceReuqirements=n,a.content="好的，你的需求如下：\n".concat(this.serviceReuqirements,"\n你可以继续提出你的机器人服务定制需求或者进行修改。也可以告诉我你已经完成了你的需求描述，我会为你生成机器人的行为程序。\n            ");break;case"modifiedrequire":this.serviceReuqirements=n,a.content="好的，你修改后的需求如下：\n              ".concat(this.serviceReuqirements,"\n              你可以继续提出你的机器人服务定制需求或者进行修改。也可以告诉我你已经完成了你的需求描述，我会为你生成机器人的行为程序。\n            ");break;case"end":a.content="好的，你的需求如下：\n".concat(this.serviceReuqirements,"\n即将为你生成机器人的服务流程，请稍候...\n            "),this.initCode();break;default:console.log("没有找到xml标记")}},initCode:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n,a,s;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.addMessage("正在根据你的需求构建服务流程...","assistant"),n=e.messages[e.messages.length-1],console.log("serviceGoal",e.serviceGoal),console.log("serviceReuqirements",e.serviceReuqirements),s="\n        实现一个".concat(e.serviceGoal,"的服务，该服务需要满足以下需求：").concat(e.serviceReuqirements,"\n        "),t.next=7,e.NL2JS(s);case 7:return e.currentJSCode=t.sent,console.log("【currentJSCode】",e.currentJSCode),t.next=11,e.JS2NL(e.currentJSCode).then((function(t){console.log("【explainContent】",t),n.content=t,e.scrollToButton()}));case 11:return e.addMessage("正在绘制定制服务的流程图，请稍候。","assistant"),a=e.messages[e.messages.length-1],t.next=15,e.js2flow(e.currentJSCode);case 15:s=t.sent,e.currentFlowCode=s,u.$emit("callGetData",e.currentFlowCode),a.content="已完成个性化机器人服务的构建！请通过流程图查阅定制机器人服务是否符合你的需求。您可以：\n- 直接向我提出修改需求，我会帮你完成修改。\n- 通过节点调试功能来让我解释某个（或者多个）节点的行为，并让我为你修改。\n- 直接编辑流程图以修改机器人的行为。\n        ",e.scrollToButton(),e.currentStage=je;case 21:case"end":return t.stop()}}),t)})))()},getChatContent:function(e){return e.replace(/<.*?>(.*?)<\/.*?>/g,"")},getXMLcontent:function(e,t){var n=new RegExp("<".concat(t,">(.*?)</").concat(t,">"),"g");e=e.match(n);return null==e?(console.log("没有找到".concat(t,"标记")),null):e[0].replace(new RegExp("<".concat(t,">"),"g"),"").replace(new RegExp("</".concat(t,">"),"g"),"")},getPhase:function(e){return e=e.match(/<phase>(.*?)<\/phase>/g),null==e?(console.log("没有找到phase标记"),null):e[0].replace(/<phase>/g,"").replace(/<\/phase>/g,"")},authoringNEW:function(e){return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/authoringNEW"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat:e,sessionID:ae.id})});case 2:return n=t.sent,t.next=5,n.text().then((function(e){return e}));case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},authoring:function(e){return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/authoring"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat:e,sessionID:ae.id})});case 2:return n=t.sent,t.next=5,n.text().then((function(e){return e}));case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},TemiServiceBuild:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("temiServiceBuild"),e.addMessage("正在部署中....","assistant"),t.next=4,fetch("".concat("http://192.168.123.70:3001","/APIs/js2temi"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e.currentJSCode,sessionID:ae.id})});case 4:return n=t.sent,t.next=7,n.text().then((function(e){return console.log("data",e),e}));case 7:n=t.sent,e.messages[e.messages.length-1].content=n,e.scrollToButton();case 11:case"end":return t.stop()}}),t)})))()},NL2JS:function(e){return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/nl2js"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,sessionID:ae.id})});case 2:return n=t.sent,t.next=5,n.text().then((function(e){return e}));case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},NL2JSwithContext:function(e,t){return Object(ne.a)(Object(te.a)().mark((function n(){var a;return Object(te.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/nl2jswithContext"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,context:t})});case 2:return a=n.sent,n.next=5,a.text().then((function(e){return console.log("data",e),e}));case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})))()},ExplainModifiedJS:function(e,t){return Object(ne.a)(Object(te.a)().mark((function n(){var a;return Object(te.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/explainModifiedJS"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:e,modified:t})});case 2:return a=n.sent,n.next=5,a.text().then((function(e){return console.log("data",e),e}));case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})))()},JS2NL:function(e){return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/js2NLexplain"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});case 2:return n=t.sent,t.next=5,n.text().then((function(e){return e}));case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},js2flow:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://192.168.123.70:3001","/APIs/js2flow"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e.currentJSCode,sessionID:ae.id})});case 2:return n=t.sent,t.next=5,n.text().then((function(e){return console.log("【js2flow result】",e),e}));case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},addMessage:function(e,t){this.messages.push({id:this.messageCounter++,content:e,role:t}),this.scrollToButton()},scrollToButton:function(){var e=this;this.$nextTick((function(){var t=e.$el.querySelector(".chat-container");t.scrollTop=t.scrollHeight}))},resizeTextarea:function(e){e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},changeRobotJsCode:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n,a;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("开始根据流程图修改生成代码"),console.log("currentJSCode: ",e.currentJSCode),console.log("oldMermaidData: ",e.currentFlowCode),console.log("newMermaidData: ",e.newMermaidData),e.addMessage("正在按照修改后的流程图生成新的机器人服务流程，请等待...","assistant"),n=e.messages[e.messages.length-1],t.next=8,fetch("//192.168.123.70:3001/APIs/flow2js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jscode:e.currentJSCode,oldFlow:e.currentFlowCode,newFlow:e.newMermaidData,sessionID:ae.id})});case 8:return a=t.sent,t.next=11,a.text().then((function(e){return console.log("new jscode data",e),e}));case 11:return a=t.sent,e.currentJSCode=a,console.log("new jscode: ",e.currentJSCode),e.currentFlowCode=e.newMermaidData,n.content="已经为你按照修改后的流程图重新生成机器人的服务程序",t.abrupt("return",a);case 17:case"end":return t.stop()}}),t)})))()},magicUpdateWithLLM:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n,a,s;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log("chatview中的魔法棒: ",e.selectedCells),n=[],a=0;a<e.selectedCells.length;a++)e.selectedCells[a].isNode()?(console.log("find node!"),n.push(e.selectedCells[a].data.actionType+": "+e.selectedCells[a].data.tooltip)):console.log("not node!");return console.log("selectNodesID: ",n),e.currentSeletecNodes=n,e.addMessage("正在思考解释你选中的节点....","magic"),t.next=8,fetch("".concat("http://192.168.123.70:3001","/APIs/magicModify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionID:ae.id,selectedNodes:e.currentSeletecNodes,jscode:e.currentJSCode,flow:e.currentFlowCode})});case 8:return s=t.sent,t.next=11,s.text().then((function(t){return console.log("data from magic modify: ",t),e.messages[e.messages.length-1].content=t,e.currentStage=Ae,t}));case 11:case"end":return t.stop()}}),t)})))()},magicModifyIT:function(e){var t=this;return Object(ne.a)(Object(te.a)().mark((function n(){var a,s,o,c,i,r;return Object(te.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.addMessage("正在思考....","magic"),n.next=3,fetch("".concat("http://192.168.123.70:3001","/APIs/magicModifyPhase"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionID:ae.id,selectedNodes:t.currentSeletecNodes,jscode:t.currentJSCode,flow:t.currentFlowCode,text:e})});case 3:return i=n.sent,n.next=6,i.text().then((function(e){return console.log("data from magic modify: ",e),e}));case 6:if(-1!=(a=n.sent).indexOf("<end>")&&(t.messages[t.messages.length-1].content="退出节点调试模式",t.addMessage("你可以继续提出你的服务流程修改需求，我会帮助你进行修改。","assistant"),t.currentStage=je),-1!=a.indexOf("<code>"))return(s=t.messages[t.messages.length-1]).content="正在生成新的服务流程....",o=a.substring(a.indexOf("<code>")+6,a.indexOf("</code>")),t.currentJSCode=o,c=a.substring(a.indexOf("<description>")+13,a.indexOf("</description>")),n.next=16,t.js2flow(t.currentJSCode);n.next=22;break;case 16:i=n.sent,t.currentFlowCode=i,u.$emit("callGetData",t.currentFlowCode),s.content=c,t.currentJSCode=o,t.addMessage("已退出节点调试模式。你现在可以继续提出你对整个服务流程的修改要求。或者再次选中节点进入节点调试模式进行修改。","assistant");case 22:-1!=a.indexOf("<explain>")&&(r=a.substring(a.indexOf("<explain>")+9,a.indexOf("</explain>")),t.messages[t.messages.length-1].content=r);case 23:case"end":return n.stop()}}),n)})))()},startRunTemi:function(){var e=this;return Object(ne.a)(Object(te.a)().mark((function t(){var n;return Object(te.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("chatView 子组件startRunTemi方法被调用了！"),console.log("current jscode:"+e.currentJSCode),0<e.currentJSCode.length)return t.next=5,fetch("".concat("http://192.168.123.70:3001","/APIs/js2temi"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionID:ae.id,text:e.currentJSCode})});t.next=8;break;case 5:return n=t.sent,t.next=8,n.text().then((function(t){return console.log(t),e.addMessage(t,"assistant"),t}));case 8:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;this.$refs.textarea.addEventListener("input",this.resizeTextarea),this.addMessage("你好，我是你的助手，我将帮助你进行Temi机器人的服务定制，请你告诉我你的机器人个性化服务定制需求","assistant"),u.$on("send-new-mermaid-data",(function(t){e.newMermaidData=t,e.changeRobotJsCode()})),u.$on("magic-selected-cells",(function(t){e.selectedCells=t,e.magicUpdateWithLLM()}))},beforeDestroy:function(){u.$off("send-new-mermaid-data"),u.$off("magic-selected-cells")}};n("d8d9"),se={components:{x6:se,chatView:Object(t.a)(Ie,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"chat"}},[n("div",{staticClass:"chat-icon"},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/logo.png"}}),n("span",{staticClass:"chat-title"},[e._v("co-CoBot")])]),n("div",{staticClass:"chat-container"},e._l(e.messages,(function(t){return n("div",{key:t.id,staticClass:"message",class:t.role},[n("div",{staticClass:"content",class:{user:"content-user",assistant:"content-assistant",magic:"content-magic"}[t.role]},[e._v(" "+e._s(t.content)+" ")])])})),0),n("div",{staticClass:"input-container"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.userInput,expression:"userInput"}],ref:"textarea",staticClass:"chat-input",attrs:{placeholder:"请输入内容"},domProps:{value:e.userInput},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)},input:function(t){t.target.composing||(e.userInput=t.target.value)}}}),n("button",{staticClass:"chatButton",on:{click:e.sendMessage}},[n("img",{attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/sendButton.png",alt:"按钮"}})])])])}),[],!1,null,null,null).exports},data:function(){return{titleData:o.default.observable({title:"标题从子组件传递给父组件，困扰了我2天，无法解决，只能通过页面中点按钮，从子组件传给父组件，而无法自动"}),newTitleData:"",VUE_APP_ICON_Server:"http://192.168.123.70:5500"}},methods:{handleTitleFromX6:function(e){console.log("Received title from x6:",e),this.titleData.title=e},runInTemi:function(){console.log("部署到temi上"),this.$refs.chatViewRef.startRunTemi(),Ee.Message.success("成功部署到temi！")}}},n("7f00"),Ie=Object(t.a)(se,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("div",{staticClass:"container"},[t("div",{staticClass:"title-container"},[t("div",{staticClass:"title-center"},[t("a",{staticClass:"title",attrs:{href:"https://github.com/g0ngjie/antv-x6-vue2"}},[e._v(e._s(e.titleData.title))])]),t("div",{staticClass:"title-buttons"},[t("button",{staticClass:"title-button",on:{click:e.runInTemi}},[t("img",{staticClass:"title-button-img2",attrs:{src:e.VUE_APP_ICON_Server+"/packages/icons/play.png"}})])])]),t("div",{staticClass:"inner-container"},[t("div",{staticClass:"Flow-Wrapper"},[t("x6",{on:{"title-to-parent":e.handleTitleFromX6}})],1),t("div",{staticClass:"ChatView-Wrapper"},[t("chatView",{ref:"chatViewRef"})],1)])])}),[],!1,null,null,null).exports;o.default.use(r.a),t=new r.a({routes:[{path:"/",name:"x6",component:Ie},{path:"*",redirect:"/"}]}),n("0f4c"),o.default.use(y.a),o.default.use(oe),o.default.config.productionTip=!1,new o.default({router:t,render:function(e){return e(i)}}).$mount("#app")},d8d9:function(e,t,n){"use strict";n("1bae")},db45:function(e,t,n){"use strict";n("f70a")},e72d:function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-focus",use:"icon-focus-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-focus"><defs><style></style></defs><path d="M880.306 463.051h-34.85c-15.002-151.086-135.154-271.233-286.248-286.235v-34.849c0-16.955-13.744-30.699-30.7-30.699h-2.563c-16.956 0-30.7 13.744-30.7 30.7v34.848C344.152 191.818 224 311.966 208.998 463.051h-34.85c-16.955 0-30.701 13.744-30.701 30.7v2.562c0 16.955 13.746 30.699 30.7 30.699h34.85C224 678.099 344.153 798.245 495.246 813.247v34.849c0 16.955 13.745 30.699 30.7 30.699h2.563c16.956 0 30.7-13.744 30.7-30.7v-34.848c151.094-15.002 271.245-135.15 286.248-286.235h34.85c16.956 0 30.7-13.744 30.7-30.7v-2.562c0-16.955-13.744-30.699-30.7-30.699zM765.361 595.596c-13.012 30.764-31.653 58.404-55.406 82.156-23.752 23.751-51.395 42.392-82.16 55.404a255.55 255.55 0 01-68.587 18.333V623.392c0-16.955-13.744-30.7-30.7-30.7h-2.563c-16.956 0-30.7 13.745-30.7 30.7v128.097a255.56 255.56 0 01-68.587-18.333c-30.765-13.011-58.407-31.652-82.16-55.404-23.752-23.75-42.393-51.392-55.406-82.156a255.485 255.485 0 01-18.334-68.584H398.86c16.954 0 30.7-13.744 30.7-30.7v-2.562c0-16.955-13.746-30.699-30.7-30.699H270.758a255.485 255.485 0 0118.334-68.584c13.012-30.764 31.653-58.404 55.406-82.156 23.752-23.75 51.395-42.391 82.16-55.404a255.554 255.554 0 0168.586-18.333V366.67c0 16.955 13.745 30.7 30.7 30.7h2.563c16.955 0 30.7-13.745 30.7-30.7V238.574a255.513 255.513 0 0168.587 18.333c30.765 13.011 58.407 31.652 82.16 55.404 23.753 23.75 42.393 51.392 55.406 82.156a255.485 255.485 0 0118.334 68.584H655.591c-16.956 0-30.7 13.744-30.7 30.7v2.562c0 16.955 13.744 30.699 30.7 30.699h128.103a255.531 255.531 0 01-18.333 68.584z" /></symbol>'});n.a.add(s),t.default=s},f160:function(e,t,n){var a={"./copy.svg":"65b8","./dustbin.svg":"8eda","./focus.svg":"e72d","./redo.svg":"b933","./select_all.svg":"f2db","./select_cancel.svg":"9b3e","./tips.svg":"2599","./undo.svg":"27ff","./zoomin.svg":"ab20","./zoomout.svg":"774b"};function s(e){return e=o(e),n(e)}function o(e){if(n.o(a,e))return a[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}s.keys=function(){return Object.keys(a)},s.resolve=o,(e.exports=s).id="f160"},f2db:function(e,t,n){"use strict";n.r(t);var a=n("7682"),s=(a=n.n(a),n("4598"));n=n.n(s),s=new a.a({id:"icon-select_all",use:"icon-select_all-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="icon-select_all"><path d="M684.973 754.162H228.324a69.19 69.19 0 01-69.189-69.189V228.324a69.19 69.19 0 0169.19-69.189h456.648a69.19 69.19 0 0169.19 69.19v456.648a69.19 69.19 0 01-69.19 69.19zM228.324 214.486a13.838 13.838 0 00-13.838 13.838v456.649a13.838 13.838 0 0013.838 13.838h456.649a13.838 13.838 0 0013.838-13.838V228.324a13.838 13.838 0 00-13.838-13.838zm567.352 650.379H325.189A69.19 69.19 0 01256 795.675v-69.189a27.676 27.676 0 0155.351 0v69.19a13.838 13.838 0 0013.838 13.838h470.487a13.838 13.838 0 0013.838-13.838V325.189a13.838 13.838 0 00-13.838-13.838h-69.19a27.676 27.676 0 010-55.351h69.19a69.19 69.19 0 0169.189 69.19v470.486a69.19 69.19 0 01-69.19 69.189zM411.814 603.468a27.676 27.676 0 01-19.65-8.441l-87.732-87.732a27.676 27.676 0 0139.162-39.16l69.189 69.188 184.873-186.672a27.676 27.676 0 1138.885 39.16L431.325 595.028a27.676 27.676 0 01-19.51 8.441z" /></symbol>'});n.a.add(s),t.default=s},f70a:function(e,t,n){}});